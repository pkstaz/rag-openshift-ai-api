# =============================================================================
# RAG OpenShift AI API - Helm Values
# =============================================================================
# Default configuration for OpenShift deployment

# Image configuration
image:
  repository: quay.io/cestayg/rag-openshift-ai-api
  tag: "dev-16"
  pullPolicy: "Always"

# Application configuration
app:
  name: "rag-openshift-ai-api"
  port: 8000
  replicas: 1

# Deployment optimization
terminationGracePeriodSeconds: 30
revisionHistoryLimit: 3
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0

# Service configuration
service:
  type: ClusterIP
  port: 8000
  targetPort: 8000

# Route configuration (OpenShift)
route:
  enabled: true
  hostname: ""  # Auto-generated by OpenShift

# Resource configuration
resources:
  requests:
    cpu: "400m"
    memory: "768Mi"
  limits:
    cpu: "1500m"
    memory: "3Gi"

# Elasticsearch configuration
elasticsearch:
  url: "https://elasticsearch-es-default:9200"
  indexName: "rag-documents"
  username: "elastic"
  password: "25im5Ru59a1V1qAIRg9gc02A"
  timeout: 30
  vectorDimension: 384

# vLLM configuration
vllm:
  endpoint: "http://granite-3-1-8b-instruct-predictor.rag-openshift-ai.svc.cluster.local:8080"
  defaultModel: "granite-3-1-8b-instruct"
  timeout: 60
  temperature: 0.7
  maxTokens: 512

# Embedding configuration
embedding:
  modelName: "sentence-transformers/all-MiniLM-L6-v2"
  device: "cpu"
  batchSize: 32

# RAG configuration
rag:
  topK: 5
  similarityThreshold: 0.7
  searchType: "vector"
  chunkSize: 1000
  chunkOverlap: 200

# API configuration
api:
  debug: true
  logLevel: "DEBUG"
  corsOrigins: ["*"]
  corsMethods: ["GET", "POST", "PUT", "DELETE"]

# Monitoring configuration
monitoring:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: "30s"
  prometheusRule:
    enabled: true

# Security configuration
security:
  runAsNonRoot: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Pod Security Context
podSecurityContext:

# Network policy
networkPolicy:
  enabled: false
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              name: allowed-namespace
      ports:
        - protocol: TCP
          port: 8000

# Horizontal Pod Autoscaler
hpa:
  enabled: true
  minReplicas: 1
  maxReplicas: 8
  targetCPUUtilizationPercentage: 75
  targetMemoryUtilizationPercentage: 80

# Pod Disruption Budget
pdb:
  enabled: true
  minAvailable: 1

# ConfigMap and Secret
configMap:
  create: true
  name: "rag-api-config"

secret:
  create: true
  name: "rag-api-secrets"

secretKey: "your-secret-key"

secrets:
  elasticsearch:
    enabled: false
    secretName: ""
  vllm:
    enabled: false
    secretName: ""

logging:
  fluentd:
    enabled: false 